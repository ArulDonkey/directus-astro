---
import { readItems } from "@directus/sdk";
import directus from "../lib/directus";
import Layout from "../layouts/Layout.astro";

const courses = await directus.request(
  readItems("course", {
    fields: [
      "judulKursus",
      "id",
      {
        program: ["id", "judul", "slug", "hero"],
      },
    ],
  })
);
---

<Layout>
<h1 class="text-3xl font-bold mb-6 text-center">Daftar Programs</h1>

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 justify-items-center">
    {
      courses.map((c) =>
        c.program?.map((p) => (
          <a 
            href={`/programs/${p.slug}`} 
            class="bg-white border rounded-xl shadow-md hover:shadow-xl transition w-full max-w-sm overflow-hidden flex flex-col"
          >
            {p.hero && (
              <img 
                src={`http://localhost:8055/assets/${p.hero}`} 
                alt={p.judul} 
                class="w-full h-40 object-cover"
              />
            )}
            <div class="p-4 text-center">
              <h3 class="text-lg font-semibold text-gray-800">{p.judul}</h3>
              <p class="text-sm text-sky-600 mt-2 font-medium">{c.judulKursus}</p>
            </div>
          </a>
        ))
      )
    }
  </div>

</Layout>